var _0xa285=["\x6A\x73\x6F\x6E\x5F\x74\x6F\x5F\x73\x68\x65\x65\x74","\x75\x74\x69\x6C\x73","\x62\x6F\x6F\x6B\x5F\x6E\x65\x77","\x44\x56\x4B\x54","\x62\x6F\x6F\x6B\x5F\x61\x70\x70\x65\x6E\x64\x5F\x73\x68\x65\x65\x74","\x64\x76\x6B\x74\x5F\x78\x65\x70\x5F\x6C\x69\x63\x68\x5F\x6E\x67\x75\x79\x65\x6E\x5F\x74\x72\x61\x6E\x67\x2E\x78\x6C\x73\x78","\x77\x72\x69\x74\x65\x46\x69\x6C\x65","\x4D\x41\x5F\x42\x4E","\x54\x45\x4E\x5F\x42\x4E","\x4D\x41\x5F\x44\x56","\x54\x45\x4E\x5F\x44\x56","\x54\x47\x5F\x43\x48\x49\x5F\x44\x49\x4E\x48","\x50\x48\x41\x55\x54\x48\x55\x41\x54\x56\x49\x45\x4E","\x4E\x47\x41\x59\x50\x48\x41\x55\x54\x48\x55\x41\x54\x54\x48\x55\x54\x48\x55\x41\x54","","\x4B\x45\x54\x54\x48\x55\x43\x50\x54\x54\x54","\x6D\x61\x70","\x64\x76\x6B\x74\x5F\x63\x68\x69\x61\x5F\x6C\x69\x63\x68\x2E\x78\x6C\x73\x78","\x6D\x61\x74\x63\x68","\x30","\x70\x61\x64\x53\x74\x61\x72\x74","\x66\x6C\x6F\x6F\x72","\x3A","\x43\x48\x45\x43\x4B\x45\x44","\x70\x75\x73\x68","\x66\x6F\x72\x45\x61\x63\x68","\x53\x4F\x5F\x50\x48\x55\x54\x5F\x4B\x54\x56","\x66\x69\x6C\x74\x65\x72","\x74\x72\x69\x6D","\x3B","\x73\x70\x6C\x69\x74","\x64","\x6C\x6F\x63\x61\x6C\x65\x43\x6F\x6D\x70\x61\x72\x65","\x73\x6F\x72\x74","\x6C\x65\x6E\x67\x74\x68","\x73\x74\x61\x72\x74","\x6D\x61\x78","\x53\x4F\x5F\x50\x48\x55\x54\x5F\x42\x4E","\x65\x6E\x64","\x44\x4F\x4E\x45","\x6B\x74\x76","\x4D\x41\x5F\x42\x53","\x63\x68\x69\x61\x4C\x69\x63\x68"];function exportExcelKeepOriginal(_0x2111x2){const _0x2111x3=XLSX[_0xa285[1]][_0xa285[0]](_0x2111x2,{skipHeader:false});const _0x2111x4=XLSX[_0xa285[1]][_0xa285[2]]();XLSX[_0xa285[1]][_0xa285[4]](_0x2111x4,_0x2111x3,_0xa285[3]);XLSX[_0xa285[6]](_0x2111x4,_0xa285[5])}function exportExcel(_0x2111x6){const _0x2111x7=_0x2111x6[_0xa285[16]]((_0x2111x8,_0x2111x9)=>{return ({STT:_0x2111x9+ 1,MA_BN:_0x2111x8[_0xa285[7]],TEN_BN:_0x2111x8[_0xa285[8]],MA_DV:_0x2111x8[_0xa285[9]],TEN_DV:_0x2111x8[_0xa285[10]],TG_CHI_DINH:_0x2111x8[_0xa285[11]],PHAUTHUATVIEN:_0x2111x8[_0xa285[12]],BAT_DAU:_0x2111x8[_0xa285[13]]|| _0xa285[14],KET_THUC:_0x2111x8[_0xa285[15]]|| _0xa285[14]})});const _0x2111x3=XLSX[_0xa285[1]][_0xa285[0]](_0x2111x7);const _0x2111x4=XLSX[_0xa285[1]][_0xa285[2]]();XLSX[_0xa285[1]][_0xa285[4]](_0x2111x4,_0x2111x3,_0xa285[3]);XLSX[_0xa285[6]](_0x2111x4,_0xa285[17])}function timeToMin(_0x2111xb){if(!_0x2111xb){return null};const _0x2111xc=_0x2111xb[_0xa285[18]](/(\d{1,2}):(\d{2})/);return _0x2111xc?Number(_0x2111xc[1])* 60+ Number(_0x2111xc[2]):null}function minToTime(_0x2111xc){const _0x2111xe=String(Math[_0xa285[21]](_0x2111xc/ 60))[_0xa285[20]](2,_0xa285[19]);const _0x2111xf=String(_0x2111xc% 60)[_0xa285[20]](2,_0xa285[19]);return (""+_0x2111xe+_0xa285[22]+_0x2111xf+_0xa285[14])}function buildBnBusy(_0x2111x11){const _0x2111xc={};_0x2111x11[_0xa285[25]]((_0x2111x8)=>{if(_0x2111x8[_0xa285[23]]=== true&& _0x2111x8[_0xa285[13]]){const _0x2111x12=timeToMin(_0x2111x8.NGAYPHAUTHUATTHUTHUAT);const _0x2111x13=timeToMin(_0x2111x8.KETTHUCPTTT);if(_0x2111x12!= null&& _0x2111x13!= null){_0x2111xc[_0x2111x8[_0xa285[7]]]= _0x2111xc[_0x2111x8[_0xa285[7]]]|| [];_0x2111xc[_0x2111x8[_0xa285[7]]][_0xa285[24]]({start:_0x2111x12,end:_0x2111x13})}}});return _0x2111xc}function buildKtvBusy(_0x2111x11){const _0x2111xc={};_0x2111x11[_0xa285[25]]((_0x2111x8)=>{if(_0x2111x8[_0xa285[23]]=== true&& _0x2111x8[_0xa285[12]]){const _0x2111x12=timeToMin(_0x2111x8.NGAYPHAUTHUATTHUTHUAT);if(_0x2111x12!= null){_0x2111x8[_0xa285[12]][_0xa285[30]](_0xa285[29])[_0xa285[16]]((_0x2111x16)=>{return _0x2111x16[_0xa285[28]]()})[_0xa285[27]](Boolean)[_0xa285[25]]((_0x2111x15)=>{_0x2111xc[_0x2111x15]= _0x2111xc[_0x2111x15]|| [];_0x2111xc[_0x2111x15][_0xa285[24]]({start:_0x2111x12,gap:_0x2111x8[_0xa285[26]]|| 0})})}}});return _0x2111xc}function chiaLich(_0x2111x18,_0x2111x19){const _0x2111x11=_0x2111x19[_0xa285[16]]((_0x2111x8)=>{return ({..._0x2111x8,CHECKED:_0x2111x8[_0xa285[23]]=== true})});const _0x2111x1a=buildBnBusy(_0x2111x11);const _0x2111x1b=buildKtvBusy(_0x2111x11);const _0x2111x1c=buildKtvShift(_0x2111x18);const _0x2111x1d=_0x2111x11[_0xa285[16]]((_0x2111x8,_0x2111x9)=>{return ({d,i})})[_0xa285[27]]((_0x2111x16)=>{return _0x2111x16[_0xa285[31]][_0xa285[23]]!== true})[_0xa285[33]]((_0x2111x1e,_0x2111x1f)=>{const _0x2111x20=timeToMin(_0x2111x1e[_0xa285[31]].TG_CHI_DINH);const _0x2111x21=timeToMin(_0x2111x1f[_0xa285[31]].TG_CHI_DINH);if(_0x2111x20== null&& _0x2111x21!= null){return 1};if(_0x2111x20!= null&& _0x2111x21== null){return -1};if(_0x2111x20!= null&& _0x2111x21!= null&& _0x2111x20!== _0x2111x21){return _0x2111x20- _0x2111x21};return (_0x2111x1e[_0xa285[31]][_0xa285[9]]|| _0xa285[14])[_0xa285[32]](_0x2111x1f[_0xa285[31]][_0xa285[9]]|| _0xa285[14])});_0x2111x1d[_0xa285[25]](({_0x2111x8,_0x2111x9})=>{let _0x2111x22=timeToMin(_0x2111x8.TG_CHI_DINH);if(_0x2111x22== null){return};const _0x2111x23=_0x2111x8[_0xa285[7]];_0x2111x1a[_0x2111x23]= _0x2111x1a[_0x2111x23]|| [];const _0x2111x24=(_0x2111x8[_0xa285[12]]|| _0xa285[14])[_0xa285[30]](_0xa285[29])[_0xa285[16]]((_0x2111x16)=>{return _0x2111x16[_0xa285[28]]()})[_0xa285[27]](Boolean);const _0x2111x25=_0x2111x24[_0xa285[34]]?_0x2111x24:[null];let _0x2111x26=null;_0x2111x25[_0xa285[25]]((_0x2111x27)=>{const _0x2111x28=_0x2111x27?(_0x2111x1c[_0x2111x27]|| []):[{start:_0x2111x22,end:1440}];_0x2111x1b[_0x2111x27]= _0x2111x1b[_0x2111x27]|| [];_0x2111x28[_0xa285[25]]((_0x2111x29)=>{let _0x2111x2a=Math[_0xa285[36]](_0x2111x22,_0x2111x29[_0xa285[35]]);let _0x2111x2b=0;while(_0x2111x2b++ < 500){if(_0x2111x2a+ _0x2111x8[_0xa285[37]]> _0x2111x29[_0xa285[38]]){break};let _0x2111x2c=false;for(const _0x2111x1f of _0x2111x1a[_0x2111x23]){if(_0x2111x2a< _0x2111x1f[_0xa285[38]]&& _0x2111x2a+ _0x2111x8[_0xa285[37]]> _0x2111x1f[_0xa285[35]]){_0x2111x2a= _0x2111x1f[_0xa285[38]]+ 2;_0x2111x2c= true;break}};if(_0x2111x2c){continue};if(_0x2111x27){for(const _0x2111x15 of _0x2111x1b[_0x2111x27]){if(_0x2111x2a< _0x2111x15[_0xa285[38]]&& _0x2111x2a+ _0x2111x8[_0xa285[26]]> _0x2111x15[_0xa285[35]]){_0x2111x2a= _0x2111x15[_0xa285[38]];_0x2111x2c= true;break}};if(_0x2111x2c){continue}};if(!_0x2111x26|| _0x2111x2a< _0x2111x26[_0xa285[35]]){_0x2111x26= {start:_0x2111x2a,ktv:_0x2111x27}};break}})});if(!_0x2111x26){return};const _0x2111x2d=_0x2111x26[_0xa285[35]]+ _0x2111x8[_0xa285[37]];const _0x2111x2e=_0x2111x26[_0xa285[35]]+ (_0x2111x8[_0xa285[26]]|| 0);_0x2111x11[_0x2111x9][_0xa285[23]]= _0xa285[39];_0x2111x11[_0x2111x9][_0xa285[13]]= minToTime(_0x2111x26[_0xa285[35]]);_0x2111x11[_0x2111x9][_0xa285[15]]= minToTime(_0x2111x2d);if(_0x2111x26[_0xa285[40]]){_0x2111x11[_0x2111x9][_0xa285[12]]= _0x2111x26[_0xa285[40]]};_0x2111x1a[_0x2111x23][_0xa285[24]]({start:_0x2111x26[_0xa285[35]],end:_0x2111x2d});if(_0x2111x26[_0xa285[40]]){_0x2111x1b[_0x2111x26[_0xa285[40]]][_0xa285[24]]({start:_0x2111x26[_0xa285[35]],end:_0x2111x2e})}});return _0x2111x11}function buildKtvShift(_0x2111x18){const _0x2111xc={};_0x2111x18[_0xa285[25]]((_0x2111x15)=>{if(!_0x2111xc[_0x2111x15[_0xa285[41]]]){_0x2111xc[_0x2111x15[_0xa285[41]]]= []};_0x2111xc[_0x2111x15[_0xa285[41]]][_0xa285[24]]({start:timeToMin(_0x2111x15.BAT_DAU),end:timeToMin(_0x2111x15.KET_THUC)})});return _0x2111xc}window[_0xa285[42]]= chiaLich
